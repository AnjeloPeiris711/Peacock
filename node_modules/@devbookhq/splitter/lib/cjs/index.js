"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react"),n=require("react-is");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=i(t);function a(e,t){const n=getComputedStyle(t);if(!n)return;let i=e===exports.SplitDirection.Horizontal?t.clientWidth:t.clientHeight;return 0!==i?(e===exports.SplitDirection.Horizontal?i-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight):i-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),i):void 0}function o(e,n,i=[]){t.useEffect((()=>(window.addEventListener(e,n),()=>window.removeEventListener(e,n))),[e,n,...i])}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}("/* === Main Container === */\n.__dbk__container {\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  overflow: hidden;\n}\n\n.__dbk__container.Horizontal {\n  flex-direction: row;\n}\n\n.__dbk__container.Vertical {\n  flex-direction: column;\n}\n/* ====== */\n\n/* === Wrapper for each child element === */\n.__dbk__child-wrapper {\n  height: 100%;\n  width: 100%;\n}\n/* ====== */\n\n/* === Gutter === */\n.__dbk__gutter {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n/* .__dbk__gutter > div {\n  background: red;\n} */\n.__dbk__gutter.Horizontal {\n  height: 100%;\n  padding: 0 2px;\n  flex-direction: column;\n}\n.__dbk__gutter.Horizontal:hover {\n  cursor: col-resize;\n}\n\n.__dbk__gutter.Vertical {\n  width: 100%;\n  padding: 2px 0;\n  flex-direction: row;\n}\n.__dbk__gutter.Vertical:hover {\n  cursor: row-resize;\n}\n\n.__dbk__gutter.Light {\n  background: #EDF0EF;\n}\n.__dbk__gutter.Light:hover > .__dbk__dragger {\n  background: #76747B;\n}\n\n.__dbk__gutter.Dark {\n  background: #020203;\n}\n.__dbk__gutter.Dark:hover > .__dbk__dragger {\n  background: #9995A3;\n}\n/* ====== */\n\n/* === Gutter's Dragger === */\n.__dbk__dragger {\n  border-radius: 2px;\n}\n\n.__dbk__dragger.Horizontal {\n  width: 4px;\n  height: 24px;  \n}\n\n.__dbk__dragger.Vertical {\n  width: 24px;\n  height: 4px;  \n}\n\n.__dbk__dragger.Light {\n  background: #A6ACB5;\n}\n\n.__dbk__dragger.Dark {\n  background: #434252;\n}\n/* ====== */");const s=r.default.forwardRef((({className:t,theme:n,draggerClassName:i,direction:r=exports.SplitDirection.Vertical,onMouseDown:a},o)=>{const s=`__dbk__gutter ${r} ${t||n}`,d=`__dbk__dragger ${r} ${i||n}`;return e.jsx("div",Object.assign({className:s,ref:o,dir:r,onMouseDown:a},{children:e.jsx("div",{className:d},void 0)}),void 0)}));var d,g,c;function l(e,t,n){let i,r;return t?(i=e/2,r=e):n?(i=e,r=e/2):(i=e,r=e),{aGutterSize:i,bGutterSize:r}}function u(e,t){switch(t.type){case d.SetIsReadyToCompute:return Object.assign(Object.assign({},e),{isReady:t.payload.isReady});case d.CreatePairs:{const{direction:n,children:i,gutters:r}=t.payload,o=i[0].parentNode;if(!o)throw new Error("Cannot create pairs - parent is undefined.");const s=a(n,o);if(void 0===s)throw new Error(`Cannot create pairs - parent has undefined or zero size: ${s}.`);const d=[];return i.forEach(((e,t)=>{if(t>0){const e=i[t-1],a=i[t],s=r[t-1],g=n===exports.SplitDirection.Horizontal?e.getBoundingClientRect().left:e.getBoundingClientRect().top,c=n===exports.SplitDirection.Horizontal?a.getBoundingClientRect().right:a.getBoundingClientRect().bottom,l=n===exports.SplitDirection.Horizontal?e.getBoundingClientRect().width+s.getBoundingClientRect().width+a.getBoundingClientRect().width:e.getBoundingClientRect().height+s.getBoundingClientRect().height+a.getBoundingClientRect().height,u=n===exports.SplitDirection.Horizontal?s.getBoundingClientRect().width:s.getBoundingClientRect().height,p={idx:t-1,a:e,b:a,gutter:s,parent:o,start:g,end:c,size:l,gutterSize:u,aSizePct:100/i.length,bSizePct:100/i.length};d.push(p)}})),Object.assign(Object.assign({},e),{pairs:d})}case d.StartDragging:{const{gutterIdx:n}=t.payload;return Object.assign(Object.assign({},e),{isDragging:!0,draggingIdx:n})}case d.StopDragging:return Object.assign(Object.assign({},e),{isDragging:!1});case d.CalculateSizes:{const{direction:n,gutterIdx:i}=t.payload,r=e.pairs[i],o=a(n,r.parent);if(!o)throw new Error("Cannot calculate sizes - 'pair.parent' has undefined or zero size.");const s=r.gutter[n===exports.SplitDirection.Horizontal?"clientWidth":"clientHeight"],d=0===i,g=i===e.pairs.length-1,{aGutterSize:c,bGutterSize:u}=l(s,d,g);let p,h,f,_,z;return n===exports.SplitDirection.Horizontal?(p=r.a.getBoundingClientRect().left,h=r.b.getBoundingClientRect().right,_=(r.a.getBoundingClientRect().width+c)/o*100,z=(r.b.getBoundingClientRect().width+u)/o*100,f=r.a.getBoundingClientRect().width+c+u+r.b.getBoundingClientRect().width):(p=r.a.getBoundingClientRect().top,h=r.b.getBoundingClientRect().bottom,_=(r.a.getBoundingClientRect().height+c)/o*100,z=(r.b.getBoundingClientRect().height+u)/o*100,f=r.a.getBoundingClientRect().height+c+u+r.b.getBoundingClientRect().height),e.pairs[i]=Object.assign(Object.assign({},r),{start:p,end:h,size:f,aSizePct:_,bSizePct:z,gutterSize:s}),Object.assign({},e)}default:return e}}function p(e,i=0,r=[]){return t.Children.toArray(e).reduce(((e,a,o)=>(n.isFragment(a)?e.push.apply(e,p(a.props.children,i+1,r.concat(a.key||o))):t.isValidElement(a)?e.push(t.cloneElement(a,{key:r.concat(String(a.key)).join(".")})):"string"!=typeof a&&"number"!=typeof a||e.push(a),e)),[])}!function(e){e[e.SetIsReadyToCompute=0]="SetIsReadyToCompute",e[e.CreatePairs=1]="CreatePairs",e[e.CalculateSizes=2]="CalculateSizes",e[e.StartDragging=3]="StartDragging",e[e.StopDragging=4]="StopDragging"}(d||(d={})),exports.SplitDirection=void 0,(g=exports.SplitDirection||(exports.SplitDirection={})).Horizontal="Horizontal",g.Vertical="Vertical",exports.GutterTheme=void 0,(c=exports.GutterTheme||(exports.GutterTheme={})).Light="Light",c.Dark="Dark";function h(e){return e===exports.SplitDirection.Horizontal?"col-resize":"row-resize"}const f={isReady:!1,isDragging:!1,pairs:[]};exports.default=function({direction:n=exports.SplitDirection.Horizontal,minWidths:i=[],minHeights:g=[],initialSizes:c,gutterTheme:_=exports.GutterTheme.Dark,gutterClassName:z,draggerClassName:b,children:x,onResizeStarted:C,onResizeFinished:S,classes:w=[]}){const y=p(x),[m,k]=t.useReducer(u,f),D=t.useRef(null),R=t.useRef([]),v=t.useRef([]);R.current=[],v.current=[];const B=r.default.useCallback((e=>{k({type:d.SetIsReadyToCompute,payload:{isReady:e}})}),[]),E=r.default.useCallback(((e,t)=>{k({type:d.StartDragging,payload:{gutterIdx:t}});const n=m.pairs[t];null==C||C(n.idx),n.a.style.userSelect="none",n.b.style.userSelect="none",n.gutter.style.cursor=h(e),n.parent.style.cursor=h(e),document.body.style.cursor=h(e)}),[m.pairs]),I=r.default.useCallback((()=>{k({type:d.StopDragging});const e=[];for(let t=0;t<m.pairs.length;t++){const i=m.pairs[t],r=a(n,i.parent);if(void 0===r)throw new Error("Cannot call the 'onResizeFinished' callback - parentSize is undefined");if(void 0===i.gutterSize)throw new Error("Cannot call 'onResizeFinished' callback - gutterSize is undefined");const o=0===t,s=t===m.pairs.length-1,d=i.a.getBoundingClientRect()[n===exports.SplitDirection.Horizontal?"width":"height"],{aGutterSize:g,bGutterSize:c}=l(i.gutterSize,o,s),u=(d+g)/r*100;if(e.push(u),s){const t=(i.b.getBoundingClientRect()[n===exports.SplitDirection.Horizontal?"width":"height"]+c)/r*100;e.push(t)}}if(void 0===m.draggingIdx)throw new Error("Could not reset cursor and user-select because 'state.draggingIdx' is undefined");const t=m.pairs[m.draggingIdx];null==S||S(t.idx,e),t.a.style.userSelect="",t.b.style.userSelect="",t.gutter.style.cursor="",t.parent.style.cursor="",document.body.style.cursor=""}),[m.draggingIdx,m.pairs,n]),j=r.default.useCallback(((e,t)=>{k({type:d.CalculateSizes,payload:{direction:e,gutterIdx:t}})}),[]),H=r.default.useCallback(((e,t,n)=>{k({type:d.CreatePairs,payload:{direction:e,children:t,gutters:n}})}),[]),O=r.default.useCallback(((e,t,n,i)=>{const r=t[0].parentNode;if(!r)throw new Error("Cannot set initial sizes - parent is undefined");if(void 0===a(e,r))throw new Error("Cannot set initial sizes - parent has undefined size");t.forEach(((r,a)=>{const o=a===t.length-1;let s;if(t.length>1){n[o?a-1:a].getBoundingClientRect()[e===exports.SplitDirection.Horizontal?"width":"height"]}s=i&&a<i.length?`calc(${i[a]}% - 0px)`:`calc(${100/t.length}% - 0px)`,e===exports.SplitDirection.Horizontal?(r.style.width=s,r.style.height="100%"):(r.style.height=s,r.style.width="100%")}))}),[]),G=r.default.useCallback(((e,t)=>{if(void 0===m.draggingIdx)throw new Error("Cannot adjust size - 'draggingIdx' is undefined");const n=m.pairs[m.draggingIdx];if(void 0===n.size)throw new Error("Cannot adjust size - 'pair.size' is undefined");if(void 0===n.gutterSize)throw new Error("Cannot adjust size - 'pair.gutterSize' is undefined");const i=n.aSizePct+n.bSizePct,r=t/n.size*i,a=i-t/n.size*i,o=0===m.draggingIdx,s=m.draggingIdx===m.pairs.length-1,{aGutterSize:d,bGutterSize:g}=l(n.gutterSize,o,s),c=`calc(${r}% - ${d}px)`,u=`calc(${a}% - ${g}px)`;e===exports.SplitDirection.Horizontal?(n.a.style.width=c,n.b.style.width=u):(n.a.style.height=c,n.b.style.height=u)}),[m.draggingIdx,m.pairs,n]),N=r.default.useCallback(((e,t,n)=>{if(!m.isDragging)return;if(void 0===m.draggingIdx)throw new Error("Cannot drag - 'draggingIdx' is undefined");const i=m.pairs[m.draggingIdx];if(void 0===i.start)throw new Error("Cannot drag - 'pair.start' is undefined");if(void 0===i.size)throw new Error("Cannot drag - 'pair.size' is undefined");if(void 0===i.gutterSize)throw new Error("Cannot drag - 'pair.gutterSize' is undefined");let r=function(e,t){return e===exports.SplitDirection.Horizontal?t.clientX:t.clientY}(t,e)-i.start,a=16,o=16;n.length>m.draggingIdx&&(a=n[m.draggingIdx]),n.length>=m.draggingIdx+1&&(o=n[m.draggingIdx+1]),r<i.gutterSize+a&&(r=i.gutterSize+a),r>=i.size-(i.gutterSize+o)&&(r=i.size-(i.gutterSize+o)),G(t,r)}),[m.isDragging,m.draggingIdx,m.pairs,G]);function T(e,t){if(!e.current)throw new Error("Can't add element to ref object - ref isn't initialized");t&&!e.current.includes(t)&&e.current.push(t)}return o("mouseup",(()=>{if(m.isDragging){if(void 0===m.draggingIdx)throw new Error("Cannot calculate sizes after dragging = 'state.draggingIdx' is undefined");j(n,m.draggingIdx),I()}}),[m.isDragging,I]),o("mousemove",(e=>{m.isDragging&&N(e,n,n===exports.SplitDirection.Horizontal?i:g)}),[n,m.isDragging,N,i,g]),t.useEffect((function(){if(!D.current)return;const e=D.current.parentElement;if(!e)return;const t=new ResizeObserver((()=>{const t=getComputedStyle(e),i=n===exports.SplitDirection.Horizontal?e.clientWidth:e.clientHeight;B(!!t&&!!i)}));return t.observe(e),()=>{t.disconnect()}}),[D.current,n]),t.useEffect((function(){if(m.isReady){if(!R.current||!v.current)throw new Error("Cannot create pairs - either variable 'childRefs' or 'gutterRefs' is undefined");y.length<=1?O(n,R.current,v.current,c):(O(n,R.current,v.current,c),H(n,R.current,v.current))}}),[x,m.isReady,n,O,H,c]),e.jsx("div",Object.assign({className:`__dbk__container ${n}`,ref:D},{children:m.isReady&&y.map(((t,i)=>e.jsxs(r.default.Fragment,{children:[e.jsx("div",Object.assign({ref:e=>T(R,e),className:"__dbk__child-wrapper "+(i<w.length?w[i]:"")},{children:t}),void 0),i<y.length-1&&e.jsx(s,{ref:e=>T(v,e),className:z,theme:_,draggerClassName:b,direction:n,onMouseDown:e=>function(e,t){t.preventDefault(),j(n,e),E(n,e)}(i,e)},void 0)]},i)))}),void 0)};
//# sourceMappingURL=index.js.map
